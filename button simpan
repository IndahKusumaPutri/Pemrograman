Private Sub btnsimpan_Click(sender As Object, e As EventArgs) Handles btnsimpan.Click
        Dim idjabtan As String
        Dim jengkel As String
        If (rlaki.Checked) Then
            jengkel = rlaki.Text
        Else
            jengkel = rperempuan.Text
        End If
        If txtnip.Text = "" Or txtnama.Text = "" Or cmbjabatan.Text = "" Or txtalamat.Text = "" Then
            MsgBox("Data tidak boleh kosong", MsgBoxStyle.Critical, Title:="Error")
        Else
            tbjabatan = proses.ExecuteQuery("Select * from Tb_Jabatan where Jabatan = '" & cmbjabatan.Text & "'")
            If tbjabatan.Rows.Count <> 0 Then
                idjabtan = tbjabatan.Rows(0).Item("ID_Jabatan").ToString
            End If
            tbkaryawan = proses.ExecuteQuery("Select * From Tb_Karyawan where NIP ='" & txtnip.Text & "'")
            If tbkaryawan.Rows.Count = 0 Then
                If MsgBox("Yakin ingin simpan ?", vbYesNo, "Confirmation") = vbYes Then
                    SQL = "Insert into Tb_Karyawan Values ( '" & txtnip.Text & "', '" & txtnama.Text & "', '" & idjabtan & "','" & jengkel & "','" & txttlp.Text & "', '" & txtalamat.Text & "')"
                    proses.ExecuteNonQuery(SQL)
                    MessageBox.Show("Siap...!!!", "Simpan Sukses", MessageBoxButtons.OK, MessageBoxIcon.Information)
                    Call bersih()
                    fillgrid()
                End If
            Else
                MsgBox("NIP " & txtnip.Text & " Data sudah ada .. !! ", MsgBoxStyle.
                       Critical, Title:=" silahkan input kembali")
            End If
        End If
    End Sub

    Private Sub btnubah_Click(sender As Object, e As EventArgs) Handles btnubah.Click
        Dim idjabtan As String
        Dim jengkel As String
        If (rlaki.Checked) Then
            jengkel = rlaki.Text
        Else
            jengkel = rperempuan.Text
        End If
        tbjabatan = proses.ExecuteQuery("Select * from Tb_Jabatan where Jabatan = '" & cmbjabatan.Text & "'")
        If tbjabatan.Rows.Count <> 0 Then
            idjabtan = tbjabatan.Rows(0).Item("ID_Jabatan").ToString
        End If
        SQL = "Update Tb_Karyawan set Nama_Karyawan = '" & txtnama.Text & "',  ID_Jabatan = '" & idjabtan & "',No_Tlp = '" & txttlp.Text & "',Alamat = '" & txtalamat.Text & "' where NIP = '" & txtnip.Text & "'"
        If MsgBox("Yakin ingim Mengubah data...?", vbYesNo, "Confirmation") = vbYes Then
            proses.ExecuteNonQuery(SQL)
            MessageBox.Show("Data sudah diperbaiki....!!", "Perubahan Sukses", MessageBoxButtons.OK,
                            MessageBoxIcon.Information)
            Call bersih()
            fillgrid()
        End If
    End Sub

    Private Sub dgkaryawan_CellClick(sender As Object, e As DataGridViewCellEventArgs) Handles dgkaryawan.CellClick
        Dim jengkel As String

        If e.RowIndex <> -1 And e.ColumnIndex <> -1 Then
            Try
                txtnip.Text = dgkaryawan.Rows(e.RowIndex).Cells("NIP").Value
                txtnama.Text = dgkaryawan.Rows(e.RowIndex).Cells("Nama_Karyawan").Value
                tbjabatan = proses.ExecuteQuery("Select * From Tb_Jabatan where ID_Jabatan ='" & dgkaryawan.Rows(e.RowIndex).Cells("ID_Jabatan").Value & "'")
                If tbjabatan.Rows.Count <> 0 Then
                    cmbjabatan.Text = tbjabatan.Rows(0).Item("Jabatan").ToString
                End If
                jengkel = dgkaryawan.Rows(e.RowIndex).Cells("Jenis_Kelamin").Value
                If (jengkel = "Laki-Laki") Then
                    rlaki.Checked = True
                Else
                    rperempuan.Checked = True
                End If

                txttlp.Text = dgkaryawan.Rows(e.RowIndex).Cells("No_Tlp").Value
                txtalamat.Text = dgkaryawan.Rows(e.RowIndex).Cells("Alamat").Value
            Catch Ex As Exception

                MessageBox.Show(Ex.Message.ToString)

            End Try
        End If
    End Sub
